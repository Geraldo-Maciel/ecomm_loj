{"ast":null,"code":"import { AUTENTICAR_TOKEN, AUTENTICAR, USER, DESAUTENTICAR } from '../types';\nimport axios from 'axios';\nimport { API, versao } from '../../config';\nimport { fetchCliente } from './clienteActions';\nimport { setCookie, removeCookie } from '../../utils/cookie';\nimport { getHeaders } from './helpers';\nimport Router from 'next/router';\nimport errorHandling from './errorHandling';\nexport var reauthenticate = function reauthenticate(token) {\n  return {\n    type: AUTENTICAR_TOKEN,\n    payload: token\n  };\n};\nexport var getUser = function getUser(_ref) {\n  var token = _ref.token;\n  return function (dispatch) {\n    axios.get(\"\".concat(API, \"/\").concat(versao, \"/api/usuarios\"), getHeaders(token)).then(function (response) {\n      return dispatch({\n        type: USER,\n        payload: response.data.usuario\n      });\n    })[\"catch\"](function (e) {\n      return console.log(e);\n    });\n  };\n};\nexport var autenticar = function autenticar(_ref2) {\n  var email = _ref2.email,\n      password = _ref2.password;\n  var goTo = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n  var cb = arguments.length > 2 ? arguments[2] : undefined;\n  return function (dispatch) {\n    axios.post(\"\".concat(API, \"/\").concat(versao, \"/api/usuarios/login\"), {\n      email: email,\n      password: password\n    }).then(function (response) {\n      setCookie('token', response.data.usuario.token);\n      if (goTo) Router.push(goTo);\n      dispatch({\n        type: AUTENTICAR,\n        payload: response.data\n      });\n      dispatch(fetchCliente(response.data.usuario._id, response.data.usuario.token));\n    })[\"catch\"](function (e) {\n      return cb(errorHandling(e));\n    });\n  };\n};\nexport var desautenticar = function desautenticar() {\n  return function (dispatch) {\n    removeCookie('token');\n    Router.push('/');\n    dispatch({\n      type: DESAUTENTICAR\n    });\n  };\n};\nexport var updateSenha = function updateSenha(data, token, cb) {\n  return function (dispatch) {\n    axios.put(\"\".concat(API, \"/\").concat(versao, \"/api/usuarios\"), {\n      password: data.novaSenha\n    }, getHeaders(token)).then(function (response) {\n      dispatch({\n        type: USER,\n        payload: response.data.usuario\n      });\n      cb(null);\n    })[\"catch\"](function (e) {\n      return cb(errorHandling(e));\n    });\n  };\n};\nexport default {\n  reauthenticate: reauthenticate,\n  getUser: getUser,\n  autenticar: autenticar,\n  desautenticar: desautenticar,\n  updateSenha: updateSenha\n};","map":{"version":3,"sources":["F:/ASSESSOR_ECO/ECO_LOJ/redux/actions/authActions.js"],"names":["AUTENTICAR_TOKEN","AUTENTICAR","USER","DESAUTENTICAR","axios","API","versao","fetchCliente","setCookie","removeCookie","getHeaders","Router","errorHandling","reauthenticate","token","type","payload","getUser","dispatch","get","then","response","data","usuario","e","console","log","autenticar","email","password","goTo","cb","post","push","_id","desautenticar","updateSenha","put","novaSenha"],"mappings":"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","sourcesContent":["import { \r\n    AUTENTICAR_TOKEN,\r\n    AUTENTICAR,\r\n    USER,\r\n    DESAUTENTICAR\r\n} from '../types';\r\nimport axios from 'axios';\r\nimport { API, versao } from '../../config';\r\nimport { fetchCliente } from './clienteActions';\r\nimport { setCookie, removeCookie } from '../../utils/cookie';\r\nimport { getHeaders } from './helpers';\r\nimport Router from 'next/router';\r\n\r\nimport errorHandling from './errorHandling';\r\n\r\nexport const reauthenticate = token => ({ type: AUTENTICAR_TOKEN, payload: token });\r\n\r\nexport const getUser = ({ token }) => (dispatch) => {\r\n    axios.get(`${API}/${versao}/api/usuarios`, getHeaders(token))\r\n    .then((response) => dispatch({ type: USER, payload: response.data.usuario }))\r\n    .catch(e => console.log(e));\r\n};\r\n\r\nexport const autenticar = ({ email, password }, goTo = false, cb) => dispatch => {\r\n    axios.post(`${API}/${versao}/api/usuarios/login`, {email, password})\r\n    .then((response) => {\r\n        setCookie('token', response.data.usuario.token);\r\n        if(goTo) Router.push(goTo);\r\n        dispatch({ type: AUTENTICAR, payload: response.data });\r\n        dispatch(fetchCliente(response.data.usuario._id, response.data.usuario.token));\r\n    })\r\n    .catch(e => cb(errorHandling(e)));\r\n}\r\n\r\nexport const desautenticar = () => dispatch => {\r\n    removeCookie('token');\r\n    Router.push('/');\r\n    dispatch({ type: DESAUTENTICAR });\r\n}\r\n\r\nexport const updateSenha = (data, token, cb) => dispatch => {\r\n    axios.put(\r\n        `${API}/${versao}/api/usuarios`, \r\n        { password: data.novaSenha }, \r\n        getHeaders(token)\r\n    )\r\n    .then((response) => {\r\n        dispatch({ type: USER, payload: response.data.usuario });\r\n        cb(null);\r\n    })\r\n    .catch(e => cb(errorHandling(e)));\r\n}\r\n\r\nexport default {\r\n    reauthenticate,\r\n    getUser,\r\n    autenticar,\r\n    desautenticar,\r\n    updateSenha\r\n};"]},"metadata":{},"sourceType":"module"}